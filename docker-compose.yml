version: "3"
services:
    rabbitmq:
        image: rabbitmq:latest
        hostname: rabbitmq
        ports:
          - "5672:5672"
          - "15672:15672"
        environment:
          - RABBITMQ_DEFAULT_USER=default
          - RABBITMQ_DEFAULT_PASS=default

      
    mongodb:
        image: mongo:latest
        container_name: mongodb
        restart: always
        environment:
            MONGO_INITDB_ROOT_USERNAME: root
            MONGO_INITDB_ROOT_PASSWORD: root
            MONGO_INITDB_DATABASE: SP500_DB
        ports:
            - 27017:27017
        volumes:
            - ./mongodb/mongo-init.js:/docker-entrypoint-initdb.d/mongo-init.js:ro
            - ./mongodb/data:/data/db

    flower:  
        image: mher/flower
        environment:
          - CELERY_BROKER_URL=amqp://default:default@rabbitmq:5672//
          - FLOWER_PORT=8888
        ports:  
          - 8888:8888

    